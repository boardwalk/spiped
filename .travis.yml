language: c
sudo: required
dist: trusty
compiler:
  - clang
  - gcc
os:
  - linux
  - osx
env:
  global:
    - secure: "rjuLHmxX06eohMLPep26ol9pUTEHKXcjC1STIu2XRmozjibaJCnoptqO5uzIrQdy2UAP40YG5Ay2KNyYyXb9J4WhElYtlpjjJ3B83JimAytPJK0dWGTSKVp8XYOraGq3CUBYeDkvXCbLfrY3xWzX7DhYhgY64ItgZg04ZPGY17oHrpKieNcpUfQZIcrO0/gFs89GsDiedufVhYJRFgYiWGmsKkarccQ7Uj1Gkq/Do7VCgVO2d26bSGeTpjrx1vChZHmNyXcPL5+VGXKjlhTzlq43isDlJ8HDykmSr0AGUIgNRERhs5AFvGRALHk9Anx8o8b+a6K1JJY0vaQuKjAp1gA58mKbGrSGNoezcIESRBjkOp9/ourz7Sdf/B6t4soq82B5Hcs9IrTNtfltSUt01uQn63hl7URID8nfXpAEmY0YA+HwThaBiAp3iEsbHVEinksX1Xq2ceYqu96xqzyXW5u6vDMZfSwf/XTRWNv/MA9isOqGrPpYJ4pfl+UWHeKfia5+rhz8rafxPCylzqPNoTNtKxj6pQ7uf7pQucqgiRm4PH3mBpuMgftcVfIB6mBLmg1BSRLMnhvVyERPVoHkhPrmHi6SkxTPliq3JBGXLAlsEB2oSY2Bc0Tat3BQw3cEWltItYsI/NyInKZGFMkKzdzjhepu+40nRYgRlxRkn8o="
addons:
  coverity_scan:
    project:
      name: "Tarsnap/spiped"
      description: "Build submitted via Travis CI"
    notification_email: cperciva@tarsnap.com
    build_command_prepend: ""
    build_command: "make all clean"
    branch_pattern: coverity_scan

before_install:
- test $TRAVIS_BRANCH != coverity_scan -o ${TRAVIS_JOB_NUMBER##*.} = 1 || exit 0
- 'if [[ "$TRAVIS_OS_NAME" == "linux" ]]; then sudo apt-get -qq update; fi'
- 'if [[ "$TRAVIS_OS_NAME" == "linux" ]]; then sudo apt-get install -y nmap; fi'
- 'if [[ "$TRAVIS_OS_NAME" == "osx" ]]; then brew update; fi'
- 'if [[ "$TRAVIS_OS_NAME" == "osx" ]]; then brew install nmap; fi'
- 'if [[ "$TRAVIS_OS_NAME" == "osx" && "$CC" == "gcc" ]]; then CC=gcc-4.9; $CC --version; fi'
script:
- test $TRAVIS_BRANCH != coverity_scan || exit 0
- make && make test
